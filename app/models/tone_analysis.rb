require 'unirest'

class ToneAnalysis
  attr_reader :results
  def initialize(body)

    full_response = Unirest.post("https://gateway.watsonplatform.net/tone-analyzer/api/v3/tone?version=2016-05-19",
      auth:{
        :user=>ENV["WATSON_ID"],
        :password=>ENV["WATSON_PASSWORD"]
      },
      headers:{
        "Content-Type" => 'text/plain',
        "body" => body
      }
    )

    @results = full_response.body # Parsed body

    # @results = {"vegetarian"=>true, "vegan"=>false, "glutenFree"=>false, "dairyFree"=>false, "veryHealthy"=>false, "cheap"=>false, "veryPopular"=>true, "sustainable"=>false, "weightWatcherSmartPoints"=>16, "gaps"=>"no", "lowFodmap"=>false, "ketogenic"=>false, "whole30"=>false, "servings"=>8, "preparationMinutes"=>15, "cookingMinutes"=>45, "sourceUrl"=>"http://www.averiecooks.com/2014/06/blueberry-pie-bars.html", "spoonacularSourceUrl"=>"https://spoonacular.com/blueberry-pie-bars-603134", "aggregateLikes"=>21327, "spoonacularScore"=>32.0, "healthScore"=>2.0, "creditText"=>"Averie Cooks", "sourceName"=>"Averie Cooks", "extendedIngredients"=>[{"id"=>9050, "aisle"=>"Produce", "image"=>"https://spoonacular.com/cdn/ingredients_100x100/blueberries.jpg", "name"=>"blueberries", "amount"=>2.0, "unit"=>"cups", "unitShort"=>"c", "unitLong"=>"cups", "originalString"=>"12 ounces (2 cups) blueberries (fresh or frozen; I used frozen and didn't thaw)", "metaInformation"=>["fresh", "frozen", "thaw", "(; I used and didn't )"]}, {"id"=>20027, "aisle"=>"Baking", "image"=>"https://spoonacular.com/cdn/ingredients_100x100/white-powder.jpg", "name"=>"cornstarch", "amount"=>2.0, "unit"=>"teaspoons", "unitShort"=>"t", "unitLong"=>"teaspoons", "originalString"=>"2 teaspoons cornstarch", "metaInformation"=>[]}, {"id"=>1123, "aisle"=>"Milk, Eggs, Other Dairy", "image"=>"https://spoonacular.com/cdn/ingredients_100x100/egg.jpg", "name"=>"egg", "amount"=>1.0, "unit"=>"", "unitShort"=>"", "unitLong"=>"", "originalString"=>"1 large egg", "metaInformation"=>["large"]}, {"id"=>20081, "aisle"=>"Baking", "image"=>"https://spoonacular.com/cdn/ingredients_100x100/flour.png", "name"=>"flour", "amount"=>1.5, "unit"=>"cups", "unitShort"=>"c", "unitLong"=>"cups", "originalString"=>"1 1/2 cups all-purpose flour", "metaInformation"=>["all-purpose"]}, {"id"=>19335, "aisle"=>"Baking", "image"=>"https://spoonacular.com/cdn/ingredients_100x100/sugar-cubes.jpg", "name"=>"granulated sugar", "amount"=>0.5, "unit"=>"cup", "unitShort"=>"c", "unitLong"=>"cups", "originalString"=>"1/2 cup granulated sugar", "metaInformation"=>[]}, {"id"=>9152, "aisle"=>"Produce", "image"=>"https://spoonacular.com/cdn/ingredients_100x100/lemon-juice.jpg", "name"=>"lemon juice", "amount"=>2.0, "unit"=>"tablespoons", "unitShort"=>"T", "unitLong"=>"tablespoons", "originalString"=>"2 tablespoons lemon juice", "metaInformation"=>[]}, {"id"=>19334, "aisle"=>"Baking", "image"=>"https://spoonacular.com/cdn/ingredients_100x100/brown-sugar-light.jpg", "name"=>"light brown sugar", "amount"=>0.25, "unit"=>"cup", "unitShort"=>"c", "unitLong"=>"cups", "originalString"=>"1/4 cup light brown sugar, packed", "metaInformation"=>["light", "packed"]}, {"id"=>18334, "aisle"=>"Baking", "image"=>"https://spoonacular.com/cdn/ingredients_100x100/pie-crust.jpg", "name"=>"pie crust", "amount"=>8.0, "unit"=>"servings", "unitShort"=>"servings", "unitLong"=>"servings", "originalString"=>"Crust and Crumble Topping", "metaInformation"=>[]}, {"id"=>2047, "aisle"=>"Spices and Seasonings", "image"=>"https://spoonacular.com/cdn/ingredients_100x100/salt.jpg", "name"=>"salt", "amount"=>1.0, "unit"=>"pinch", "unitShort"=>"pinch", "unitLong"=>"pinch", "originalString"=>"pinch salt, optional and to taste", "metaInformation"=>["to taste"]}, {"id"=>99033, "aisle"=>"Milk, Eggs, Other Dairy", "image"=>"https://spoonacular.com/cdn/ingredients_100x100/instant-vanilla-pudding.jpg", "name"=>"skim vanilla greek yogurt", "amount"=>0.5, "unit"=>"cup", "unitShort"=>"c", "unitLong"=>"cups", "originalString"=>"heaping 1/2 cup plain or vanilla Greek yogurt; or sour cream (lite is okay)", "metaInformation"=>["plain", "sour", "(lite is okay)"]}, {"id"=>1145, "aisle"=>"Milk, Eggs, Other Dairy", "image"=>"https://spoonacular.com/cdn/ingredients_100x100/butter-sliced.jpg", "name"=>"unsalted butter", "amount"=>0.5, "unit"=>"cup", "unitShort"=>"c", "unitLong"=>"cups", "originalString"=>"1/2 cup unsalted butter, melted", "metaInformation"=>["unsalted", "melted"]}, {"id"=>2050, "aisle"=>"Baking", "image"=>"https://spoonacular.com/cdn/ingredients_100x100/vanilla-extract.jpg", "name"=>"vanilla extract", "amount"=>2.0, "unit"=>"teaspoons", "unitShort"=>"t", "unitLong"=>"teaspoons", "originalString"=>"2 teaspoons vanilla extract", "metaInformation"=>[]}], "id"=>603134, "title"=>"Blueberry Pie Bars", "readyInMinutes"=>90, "image"=>"https://spoonacular.com/recipeImages/Blueberry-Pie-Bars-603134.jpg", "imageType"=>"jpg", "cuisines"=>[], "dishTypes"=>["dessert"], "pricePerServing"=>100.43, "instructions"=>"Preheat oven to 350F. Line an 8-inch square pan with aluminum foil and spray with cooking spray; set aside. Lining the pan will really help with cleanup and is recommended. Crust and Crumble Topping - In a large, microwave-safe bowl melt the butter, about 1 minute on high power. Add the sugars and whisk to combine. And the flour, optional salt, and stir to combine. Mixture will be very dry and sandy with some larger, well-formed crumble pieces. Set a heaping 3/4 cup crumble mixture aside. Transfer remaining mixture to prepared pan, and using a spatula or your fingers, hard-pack the mixture to create an even, smooth, flat crust; set aside. Filling - In a medium bowl, add the egg, Greek yogurt, sugar, vanilla, and whisk to combine. Add the flour and whisk to combine. Evenly pour filling over the crust and jiggle pan to help distribute it or smooth it with a spatula; set aside. Blueberry Layer - In a separate medium mixing bowl, add all filling ingredients and toss to combine. If sugar hasn't dissolved fully or still has crystals, that's okay because it liquifies while baking. Evenly distribute blueberry mixture over the filling. Evenly sprinkle with the reserved heaping 3/4 cup crust mixture. Before sprinkling, I squeeze the mixture in my palm to encourage bigger crumble pieces to form. Bake for about 60 minutes, or until edges are bubbling quite vigorously and there's some bubbling in the center. Crumble topping should appear set and very pale golden. I used frozen berries without thawing and the pan was very cold going into the oven. If using fresh berries, baking time will be reduced, but I'm not sure by how much, I'd guess at least 10-15 minutes, possibly less. Watch your bars, not the clock, when evaluating doneness. Place pan on a wire rack and allow bars to cool for at least 1 to 2 hours (overnight is even better) before slicing and serving. If you try to slice bars before they've cooled completely, they'll be extremely messy and could fall apart. Bars will keep airtight at room temperature for up to 1 week, in the fridge for up to 10 days (they're good slightly chilled if you like chilled pie), or in the freezer for up to 6 months.", "analyzedInstructions"=>[{"name"=>"", "steps"=>[{"number"=>1, "step"=>"Preheat oven to 350F. Line an 8-inch square pan with aluminum foil and spray with cooking spray; set aside. Lining the pan will really help with cleanup and is recommended. Crust and Crumble Topping - In a large, microwave-safe bowl melt the butter, about 1 minute on high power.", "ingredients"=>[], "equipment"=>[{"id"=>404765, "name"=>"aluminum foil", "image"=>"https://spoonacular.com/cdn/equipment_100x100/aluminum-foil.png"}, {"id"=>404783, "name"=>"bowl", "image"=>"https://spoonacular.com/cdn/equipment_100x100/bowl.jpg"}, {"id"=>404784, "name"=>"oven", "image"=>"https://spoonacular.com/cdn/equipment_100x100/oven.jpg"}, {"id"=>404645, "name"=>"frying pan", "image"=>"https://spoonacular.com/cdn/equipment_100x100/pan.png"}]}, {"number"=>2, "step"=>"Add the sugars and whisk to combine. And the flour, optional salt, and stir to combine.", "ingredients"=>[{"id"=>20081, "name"=>"all purpose flour", "image"=>"https://spoonacular.com/cdn/ingredients_100x100/flour.png"}, {"id"=>2047, "name"=>"salt", "image"=>"https://spoonacular.com/cdn/ingredients_100x100/salt.jpg"}], "equipment"=>[{"id"=>404661, "name"=>"whisk", "image"=>"https://spoonacular.com/cdn/equipment_100x100/whisk.png"}]}, {"number"=>3, "step"=>"Mixture will be very dry and sandy with some larger, well-formed crumble pieces. Set a heaping 3/4 cup crumble mixture aside.", "ingredients"=>[], "equipment"=>[]}, {"number"=>4, "step"=>"Transfer remaining mixture to prepared pan, and using a spatula or your fingers, hard-pack the mixture to create an even, smooth, flat crust; set aside. Filling - In a medium bowl, add the egg, Greek yogurt, sugar, vanilla, and whisk to combine.", "ingredients"=>[{"id"=>2050, "name"=>"vanilla", "image"=>"https://spoonacular.com/cdn/ingredients_100x100/vanilla.jpg"}, {"id"=>19335, "name"=>"sugar", "image"=>"https://spoonacular.com/cdn/ingredients_100x100/sugar-cubes.jpg"}, {"id"=>1123, "name"=>"egg", "image"=>"https://spoonacular.com/cdn/ingredients_100x100/egg.jpg"}], "equipment"=>[{"id"=>404642, "name"=>"spatula", "image"=>"https://spoonacular.com/cdn/equipment_100x100/spatula-or-turner.jpg"}, {"id"=>404661, "name"=>"whisk", "image"=>"https://spoonacular.com/cdn/equipment_100x100/whisk.png"}, {"id"=>404783, "name"=>"bowl", "image"=>"https://spoonacular.com/cdn/equipment_100x100/bowl.jpg"}, {"id"=>404645, "name"=>"frying pan", "image"=>"https://spoonacular.com/cdn/equipment_100x100/pan.png"}]}, {"number"=>5, "step"=>"Add the flour and whisk to combine. Evenly pour filling over the crust and jiggle pan to help distribute it or smooth it with a spatula; set aside. Blueberry Layer - In a separate medium mixing bowl, add all filling ingredients and toss to combine. If sugar hasn't dissolved fully or still has crystals, that's okay because it liquifies while baking. Evenly distribute blueberry mixture over the filling. Evenly sprinkle with the reserved heaping 3/4 cup crust mixture. Before sprinkling, I squeeze the mixture in my palm to encourage bigger crumble pieces to form.", "ingredients"=>[{"id"=>9050, "name"=>"blueberries", "image"=>"https://spoonacular.com/cdn/ingredients_100x100/blueberries.jpg"}, {"id"=>20081, "name"=>"all purpose flour", "image"=>"https://spoonacular.com/cdn/ingredients_100x100/flour.png"}, {"id"=>19335, "name"=>"sugar", "image"=>"https://spoonacular.com/cdn/ingredients_100x100/sugar-cubes.jpg"}], "equipment"=>[{"id"=>405907, "name"=>"mixing bowl", "image"=>"https://spoonacular.com/cdn/equipment_100x100/mixing-bowl.jpg"}, {"id"=>404642, "name"=>"spatula", "image"=>"https://spoonacular.com/cdn/equipment_100x100/spatula-or-turner.jpg"}, {"id"=>404661, "name"=>"whisk", "image"=>"https://spoonacular.com/cdn/equipment_100x100/whisk.png"}, {"id"=>404645, "name"=>"frying pan", "image"=>"https://spoonacular.com/cdn/equipment_100x100/pan.png"}]}, {"number"=>6, "step"=>"Bake for about 60 minutes, or until edges are bubbling quite vigorously and there's some bubbling in the center. Crumble topping should appear set and very pale golden. I used frozen berries without thawing and the pan was very cold going into the oven. If using fresh berries, baking time will be reduced, but I'm not sure by how much, I'd guess at least 10-15 minutes, possibly less. Watch your bars, not the clock, when evaluating doneness.", "ingredients"=>[], "equipment"=>[{"id"=>404784, "name"=>"oven", "image"=>"https://spoonacular.com/cdn/equipment_100x100/oven.jpg"}, {"id"=>404645, "name"=>"frying pan", "image"=>"https://spoonacular.com/cdn/equipment_100x100/pan.png"}]}, {"number"=>7, "step"=>"Place pan on a wire rack and allow bars to cool for at least 1 to 2 hours (overnight is even better) before slicing and serving. If you try to slice bars before they've cooled completely, they'll be extremely messy and could fall apart. Bars will keep airtight at room temperature for up to 1 week, in the fridge for up to 10 days (they're good slightly chilled if you like chilled pie), or in the freezer for up to 6 months.", "ingredients"=>[], "equipment"=>[{"id"=>405900, "name"=>"wire rack", "image"=>"https://spoonacular.com/cdn/equipment_100x100/wire-rack.jpg"}, {"id"=>404645, "name"=>"frying pan", "image"=>"https://spoonacular.com/cdn/equipment_100x100/pan.png"}]}]}]}

  end
end
